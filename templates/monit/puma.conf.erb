# Monit configuration for Puma
# <%= "#{fetch(:application)} running as #{fetch(:user)} in environment #{environment}" %>
#
# Service name: <%= fetch(:puma_monit_service_name) %>
#
check process <%= fetch(:puma_monit_service_name) %>
    with pidfile <%= fetch(:puma_pid_file) %>
    start program = "<%= fetch(:puma_monit_start_command) %>"
    stop program = "<%= fetch(:puma_monit_stop_command) %>"
    if mem is greater than <%= fetch(:puma_monit_memory_alert_threshold) %> then alert
    if mem is greater than <%= fetch(:puma_monit_memory_restart_threshold) %> then restart
    if cpu is greater than <%= fetch(:puma_monit_cpu_alert_threshold) %> then alert
    if cpu is greater than <%= fetch(:puma_monit_cpu_restart_threshold) %> then restart

    group <%= fetch(:monit_application_group_name) %>
